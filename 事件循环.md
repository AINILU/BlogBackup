#### Event Loop

> JavaScript的一大特点就是单线程，而这个线程中拥有唯一的一个事件循环。

- 一个线程中，事件循环是唯一的，但是任务队列可以拥有多个。

- 任务队列又分为macro-task（宏任务）与micro-task（微任务），在最新标准中，它们被分别称为task与jobs

- macro-task大概包括：script(整体代码), setTimeout, setInterval, setImmediate, I/O, UI rendering。

- micro-task大概包括: process.nextTick, Promise, Object.observe(已废弃), MutationObserver(html5新特性)

- setTimeout/Promise等我们称之为任务源。而进入任务队列的是他们指定的具体执行任务。

> setTimeout作为一个任务分发器，这个函数会立即执行，而它所要分发的任务，也就是它的第一个参数。

**事件循环的顺序，决定了JavaScript代码的执行顺序。**
1. *它从script(整体代码)开始第一次循环。*
2. *之后全局上下文进入函数调用栈。直到调用栈清空(只剩全局)。*
3. *然后执行所有的micro-task。当所有可执行的micro-task执行完毕之后。*
4. *循环再次从macro-task开始，找到其中一个任务队列执行完毕，然后再执行所有的micro-task，这样一直循环下去。*

> 当我们在执行setTimeout任务中遇到setTimeout时，它仍然会将对应的任务分发到setTimeout队列中去，但是该任务就得等到下一轮事件循环执行了。
